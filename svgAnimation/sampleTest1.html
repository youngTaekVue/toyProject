<!DOCTYPE html>
<html>
<head>
    <title>Google Map Lotto Store Map</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">

    <style>
        /* ì§€ë„ë¥¼ ë‹´ì„ divì˜ í¬ê¸°ëŠ” ë°˜ë“œì‹œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤. */
        #map {
            height: 100vh; /* ì „ì²´ ë·°í¬íŠ¸ ë†’ì´ */
            width: 100%; /* ì „ì²´ ë·°í¬íŠ¸ ë„ˆë¹„ */
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
<div id="map"></div>

<script>
    // -----------------------------------------------------------
    // 1. ì „ì—­ ë³€ìˆ˜ ì„ ì–¸ ë° ê°€ìƒ ë°ì´í„° (ì•½ 20ê°œ)
    // -----------------------------------------------------------

    let map; // ì§€ë„ ê°ì²´ë¥¼ ì €ì¥í•  ì „ì—­ ë³€ìˆ˜
    let currentMarkers = []; // í˜„ì¬ ì§€ë„ì— í‘œì‹œëœ ë§ˆì»¤ë“¤ì„ ê´€ë¦¬í•  ë°°ì—´
    let infoWindow; // InfoWindow ê°ì²´ë¥¼ ì €ì¥í•  ì „ì—­ ë³€ìˆ˜

    // ì§€ë„ ì¤‘ì‹¬ ì¢Œí‘œ (ì„œìš¸)
    const SEOUL_CENTER = { lat: 37.5665, lng: 126.9780 };

    // ë¡œë˜ íŒë§¤ì  ê°€ìƒ ë°ì´í„° (ì•½ 20ê°œ)
    const LOTTO_STORES = [
        { lat: 37.5668, lng: 126.9784, name: "ì„œìš¸ì‹œì²­ì ", firstWins: 5, secondWins: 12 },
        { lat: 37.5600, lng: 126.9850, name: "ëª…ë™ì ", firstWins: 10, secondWins: 25 },
        { lat: 37.5750, lng: 126.9720, name: "ê²½ë³µê¶ì—­ì ", firstWins: 2, secondWins: 5 },
        { lat: 37.5550, lng: 126.9650, name: "ë‚¨ëŒ€ë¬¸ì ", firstWins: 8, secondWins: 18 },
        { lat: 37.5800, lng: 126.9800, name: "ì¢…ë¡œ3ê°€ì ", firstWins: 15, secondWins: 30 },
        { lat: 37.5450, lng: 127.0000, name: "ì„ì§€ë¡œ4ê°€ì ", firstWins: 3, secondWins: 7 },
        { lat: 37.5300, lng: 126.9950, name: "í•œë‚¨ë™ì ", firstWins: 6, secondWins: 14 },
        { lat: 37.5250, lng: 127.0200, name: "ì••êµ¬ì •ì ", firstWins: 12, secondWins: 28 },
        { lat: 37.5100, lng: 127.0500, name: "ì‚¼ì„±ì—­ì ", firstWins: 9, secondWins: 20 },
        { lat: 37.5050, lng: 127.0650, name: "ì„ ë¦‰ì ", firstWins: 4, secondWins: 9 },
        { lat: 37.4950, lng: 127.0300, name: "ê°•ë‚¨ì—­ì ", firstWins: 18, secondWins: 40 },
        { lat: 37.5850, lng: 127.0050, name: "ë™ëŒ€ë¬¸ì ", firstWins: 7, secondWins: 16 },
        { lat: 37.5500, lng: 127.0750, name: "ê±´ëŒ€ì…êµ¬ì ", firstWins: 1, secondWins: 3 },
        { lat: 37.5900, lng: 126.9500, name: "ì‹ ì´Œì ", firstWins: 11, secondWins: 23 },
        { lat: 37.6000, lng: 127.0250, name: "ëŒ€í•™ë¡œì ", firstWins: 2, secondWins: 4 },
        { lat: 37.5400, lng: 126.9350, name: "ì—¬ì˜ë„ì ", firstWins: 14, secondWins: 35 },
        { lat: 37.4800, lng: 126.9500, name: "ë³´ë¼ë§¤ê³µì›ì ", firstWins: 3, secondWins: 6 },
        { lat: 37.4700, lng: 127.0400, name: "ì–‘ì¬ì ", firstWins: 8, secondWins: 17 },
        { lat: 37.5700, lng: 126.8900, name: "ë§ˆí¬êµ¬ì²­ì ", firstWins: 6, secondWins: 13 },
        { lat: 37.5350, lng: 126.8650, name: "ëª©ë™ì ", firstWins: 13, secondWins: 32 }
    ];

    // -----------------------------------------------------------
    // 2. ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜ (Google Maps API ì½œë°±)
    // -----------------------------------------------------------

    function initMap() {
        // ë§µ ê°ì²´ ìƒì„± ë° HTML ìš”ì†Œì— ì—°ê²°
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 12,        // ì´ˆê¸° í™•ëŒ€ ë ˆë²¨
            center: SEOUL_CENTER, // ì§€ë„ ì¤‘ì‹¬ ì¢Œí‘œ
            mapId: 'DEMO_MAP_ID'
        });

        // ì •ë³´ ì°½(InfoWindow) ê°ì²´ ìƒì„±
        infoWindow = new google.maps.InfoWindow();

        // **í•µì‹¬: ì§€ë„ ì¡°ì‘ì´ ë©ˆì¶œ ë•Œë§ˆë‹¤ ë§ˆì»¤ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.**
        map.addListener('idle', loadAndDisplayMarkers);

        // ì´ˆê¸° ë¡œë”© ì‹œ ë§ˆì»¤ í‘œì‹œ (idle ì´ë²¤íŠ¸ê°€ ìë™ìœ¼ë¡œ í˜¸ì¶œë˜ì§€ë§Œ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œ ê°€ëŠ¥)
        // loadAndDisplayMarkers();
    }

    // -----------------------------------------------------------
    // 3. ë§ˆì»¤ ë¡œë”© ë° í‘œì‹œ ë¡œì§
    // -----------------------------------------------------------

    /**
     * í˜„ì¬ ë·°í¬íŠ¸(í™”ë©´ ê²½ê³„) ë‚´ì˜ ë°ì´í„°ë§Œ í•„í„°ë§í•˜ì—¬ ë§ˆì»¤ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
     */
    function loadAndDisplayMarkers() {
        if (!map) return; // ì§€ë„ê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ì¢…ë£Œ

        // 1. ê¸°ì¡´ ë§ˆì»¤ë¥¼ ì§€ë„ì—ì„œ ìˆ¨ê¸°ê³  ë°°ì—´ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
        clearMarkers();

        // 2. í˜„ì¬ í™”ë©´ ê²½ê³„(Bounds)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
        const bounds = map.getBounds();
        if (!bounds) return; // ê²½ê³„ê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ì¢…ë£Œ

        // 3. ë¡œì»¬ ë°ì´í„°ì—ì„œ ê²½ê³„ ë‚´ì˜ íŒë§¤ì ë§Œ í•„í„°ë§í•©ë‹ˆë‹¤.
        const visibleStores = LOTTO_STORES.filter(store => {
            const position = new google.maps.LatLng(store.lat, store.lng);
            return bounds.contains(position);
        });

        // 4. í•„í„°ë§ëœ ë°ì´í„°ë¡œ ìƒˆ ë§ˆì»¤ë¥¼ ìƒì„±í•˜ì—¬ ì§€ë„ì— í‘œì‹œí•©ë‹ˆë‹¤.
        visibleStores.forEach(store => {
            const marker = createMarker(map, store);
            currentMarkers.push(marker); // ë§ˆì»¤ë¥¼ ê´€ë¦¬ ë°°ì—´ì— ì¶”ê°€
        });

        console.log(`ì§€ë„ì— ${currentMarkers.length}ê°œì˜ ë§ˆì»¤ê°€ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.`);
    }

    /**
     * ë§ˆì»¤ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  í´ë¦­ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•˜ëŠ” í—¬í¼ í•¨ìˆ˜.
     * @param {google.maps.Map} map - ì§€ë„ ê°ì²´
     * @param {Object} store - ë¡œë˜ íŒë§¤ì  ë°ì´í„° ê°ì²´
     * @returns {google.maps.Marker} ìƒì„±ëœ ë§ˆì»¤ ê°ì²´
     */
    function createMarker(map, store) {
        const position = { lat: store.lat, lng: store.lng };

        const marker = new google.maps.Marker({
            position: position,
            map: map,
            title: store.name
        });

        // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        marker.addListener('click', () => {
            const content = `
                <div style="padding: 10px;">
                    <h3>${store.name}</h3>
                    <p><strong>ë¡œë˜ 1ë“± ë‹¹ì²¨:</strong> ${store.firstWins}íšŒ ğŸ†</p>
                    <p><strong>ë¡œë˜ 2ë“± ë‹¹ì²¨:</strong> ${store.secondWins}íšŒ</p>
                </div>
            `;
            infoWindow.setContent(content);
            infoWindow.open(map, marker);
        });

        return marker;
    }

    /**
     * í˜„ì¬ ì§€ë„ì— í‘œì‹œëœ ëª¨ë“  ë§ˆì»¤ë¥¼ ì œê±°í•©ë‹ˆë‹¤.
     */
    function clearMarkers() {
        currentMarkers.forEach(marker => {
            marker.setMap(null); // ì§€ë„ì—ì„œ ë§ˆì»¤ë¥¼ ì œê±°
        });
        currentMarkers = []; // ë°°ì—´ ì´ˆê¸°í™”
    }
</script>

<script async
        src="https://maps.googleapis.com/maps/api/js?key=&callback=initMap">
</script>
</body>
</html>